"use strict";var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__export=(e,t)=>{for(var s in t)__defProp(e,s,{get:t[s],enumerable:!0})},__copyProps=(e,t,s,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of __getOwnPropNames(t))__hasOwnProp.call(e,o)||o===s||__defProp(e,o,{get:()=>t[o],enumerable:!(i=__getOwnPropDesc(t,o))||i.enumerable});return e},__toESM=(e,t,s)=>(s=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?s:__defProp(s,"default",{value:e,enumerable:!0}),e)),__toCommonJS=e=>__copyProps(__defProp({},"__esModule",{value:!0}),e),src_exports={};__export(src_exports,{default:()=>MusicJS}),module.exports=__toCommonJS(src_exports);var import_youtube_player=__toESM(require("youtube-player"));function init(){let e=document.createElement("div");e.id="yt-player",e.classList.add("yt-player"),document.body.appendChild(e);let t=document.createElement("link");return t.rel="stylesheet",t.href="https://eversoft.lk/assets/css/music-js.css",document.head.appendChild(t),(0,import_youtube_player.default)("yt-player",{playerVars:{autoplay:1,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,playsinline:1,rel:0}})}function getIdByUrl(e){let t=e.match(/youtube\.com\/watch\?v=(\w+)/),s=e.match(/youtu\.be\/(\w+)/);return t?t[1]:s?s[1]:""}function init2(){let e=new Audio;return e.volume=.5,e}function initUI(e){if(void 0===e){let t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css",document.head.appendChild(t);let s=document.createElement("div");s.classList.add("help-button-wrapper"),s.innerHTML=`
        <ul class="help-list">
        <div id="player">
          <div id="controls">
            <button id="prev"><i class="bi bi-rewind-fill"></i></button>
            <button id="play-pause"><i class="bi bi-pause-fill"></i></button>
            <button id="next"><i class="bi bi-fast-forward-fill"></i></button>
          </div>
          <div id="volume-container">
            <i class="bi bi-volume-up" id="mute-unmute"></i>
            <input
              type="range"
              id="volume"
              min="0"
              max="1"
              step="0.05"
              value="0.5"
            />
          </div>
        </div>
      </ul>

      <button class="help-button">
        <img src="/icon.png" alt="" />
      </button>
    `,document.body.appendChild(s),document.querySelector("#mute-unmute")?.addEventListener("click",async()=>{if(0===await MusicJS.getVolume()){MusicJS.setVolume(MusicJS.options?.volume??.5),document.querySelector("#mute-unmute")?.classList.remove("bi-volume-mute"),document.querySelector("#mute-unmute")?.classList.add("bi-volume-up"),document.querySelector("#volume")?.setAttribute("value",(MusicJS.options?.volume??.5).toString());return}MusicJS.setVolume(0),document.querySelector("#mute-unmute")?.classList.remove("bi-volume-up"),document.querySelector("#mute-unmute")?.classList.add("bi-volume-mute"),document.querySelector("#volume")?.setAttribute("value","0")}),document.querySelector(".help-button")?.addEventListener("click",toggleExpanded),window.addEventListener("click",e=>{let t=e.target;t.closest(".help-button-wrapper")||closeExpanded()}),document.getElementById("volume")?.addEventListener("change",e=>{let t=e.target.value;"0"===t?(document.querySelector("#mute-unmute")?.classList.remove("bi-volume-up"),document.querySelector("#mute-unmute")?.classList.add("bi-volume-mute")):(document.querySelector("#mute-unmute")?.classList.remove("bi-volume-mute"),document.querySelector("#mute-unmute")?.classList.add("bi-volume-up")),MusicJS.setVolume(parseFloat(t))}),e={playPauseButton:"#play-pause",nextButton:"#next",prevButton:"#prev"}}document.querySelector(e.playPauseButton)?.addEventListener("click",()=>{MusicJS.PlayOrPause()}),document.querySelector(e.nextButton)?.addEventListener("click",()=>{MusicJS.next()}),document.querySelector(e.prevButton)?.addEventListener("click",()=>{MusicJS.prev()})}function toggleExpanded(){document.querySelector(".help-button-wrapper")?.classList.toggle("expanded")}function closeExpanded(){document.querySelector(".help-button-wrapper")?.classList.remove("expanded")}function shuffle(e){let t=e.length,s;for(;0!==t;)s=Math.floor(Math.random()*t),t--,[e[t],e[s]]=[e[s],e[t]];return e}var MusicJS=class{static options=null;static YTPlayer=null;static AudioPlayer=null;static songs=[];static currentSongIndex=0;static init(e){if(this.options=e,initUI(e.elements),"youtube"===e.method){this.YTPlayer=init(),this.setSongs(e.src),e.randomize&&(this.songs=shuffle(this.songs)),this.setVolume(e.volume??.5),this.YTPlayer.loadVideoById(this.songs[0]),this.YTPlayer.playVideo().then(()=>{console.log("Starting to play song. It will take some time to buffer video before it starts playing.")}),this.YTPlayer.on("stateChange",e=>{0===e.data&&this.next()});return}this.AudioPlayer=init2(),this.setSongs(e.src),e.randomize&&(this.songs=shuffle(this.songs)),this.setVolume(e.volume??.5),this.AudioPlayer.src=this.songs[0],this.AudioPlayer.play().then(()=>{console.log("Starting to play song. It will take some time to buffer video before it starts playing.")}),this.AudioPlayer.addEventListener("ended",()=>{this.next()})}static setSongs(e){if(this.options?.method==="youtube"){if(Array.isArray(e)){e.forEach(e=>{let t=getIdByUrl(e);""!=t&&this.songs.push(t)});return}{let t=getIdByUrl(e);if(""!=t){this.songs.push(t);return}}}if(Array.isArray(e)){this.songs=e;return}this.songs.push(e)}static PlayOrPause(){let e=null;if(this.options?.elements!==void 0||(e=document.querySelector("#play-pause i")),this.options?.method==="youtube"){if(!this.YTPlayer)return;this.YTPlayer.getPlayerState().then(t=>{1===t?(e?.classList.remove("bi-pause-fill"),e?.classList.add("bi-play-fill"),this.YTPlayer?.pauseVideo()):(e?.classList.remove("bi-play-fill"),e?.classList.add("bi-pause-fill"),this.YTPlayer?.playVideo())});return}this.AudioPlayer&&(this.AudioPlayer.paused?(e?.classList.remove("bi-play-fill"),e?.classList.add("bi-pause-fill"),this.AudioPlayer.play()):(e?.classList.remove("bi-pause-fill"),e?.classList.add("bi-play-fill"),this.AudioPlayer.pause()))}static next(){if(this.currentSongIndex+1<this.songs.length?this.currentSongIndex+=1:this.currentSongIndex=0,this.options?.method==="youtube"){this.YTPlayer?.loadVideoById(this.songs[this.currentSongIndex]),this.YTPlayer?.playVideo();return}this.AudioPlayer&&(this.AudioPlayer.pause(),this.AudioPlayer.src=this.songs[this.currentSongIndex],this.AudioPlayer.play())}static prev(){if(this.currentSongIndex-1>=0?this.currentSongIndex-=1:this.currentSongIndex=this.songs.length-1,this.options?.method==="youtube"){this.YTPlayer?.loadVideoById(this.songs[this.currentSongIndex]),this.YTPlayer?.playVideo();return}this.AudioPlayer&&(this.AudioPlayer.pause(),this.AudioPlayer.src=this.songs[this.currentSongIndex],this.AudioPlayer.play())}static setVolume(e){if(this.options?.method==="youtube"){if(!this.YTPlayer)return;this.YTPlayer.setVolume(100*e);return}this.AudioPlayer&&(this.AudioPlayer.volume=e)}static async getVolume(){return this.options?.method==="youtube"?this.YTPlayer?await this.YTPlayer.getVolume()/100:0:this.AudioPlayer?this.AudioPlayer.volume:0}};